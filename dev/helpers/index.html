<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Helper Functions · SMC.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SMC.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../smc/">Using SMC</a></li><li class="current"><a class="toctext" href>Helper Functions</a><ul class="internal"><li><a class="toctext" href="#Helper-Functions-1">Helper Functions</a></li></ul></li><li><a class="toctext" href="../license/">License</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Helper Functions</a></li></ul><a class="edit-page" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/master/docs/src/helpers.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Helper Functions</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Helper-Functions-1" href="#Helper-Functions-1">Helper Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.Cloud-Tuple{Int64,Int64}" href="#SMC.Cloud-Tuple{Int64,Int64}"><code>SMC.Cloud</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">function Cloud(n_params::Int, n_parts::Int)</code></pre><p>Easier constructor for Cloud, which initializes the weights to be equal, and everything else in the particle object etc. to be empty.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/particle.jl#L39-L45">source</a></section><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>SMC.get_weights(c::Cloud)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>SMC.get_vals(c::Cloud; transpose::Bool = true)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>prior(parameters::ParameterVector{T}) where {T&lt;:Number}</code>. Check Documenter&#39;s build log for details.</p></div></div><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.solve_adaptive_ϕ-Tuple{Cloud,Array{Float64,1},Int64,Int64,Float64,Float64,Float64,Bool}" href="#SMC.solve_adaptive_ϕ-Tuple{Cloud,Array{Float64,1},Int64,Int64,Float64,Float64,Float64,Bool}"><code>SMC.solve_adaptive_ϕ</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">`function solve_adaptive_ϕ(cloud::Cloud, proposed_fixed_schedule::Vector{Float64},
                           i::Int64, j::Int64, ϕ_prop::Float64, ϕ_n1::Float64,
                           tempering_target::Float64, resampled_last_period::Bool)`</code></pre><p>Solves for next Φ. Returns ϕ<em>n, resampled</em>last<em>period, j, ϕ</em>prop.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/helpers.jl#L1-L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.mvnormal_mixture_draw-Union{Tuple{T}, Tuple{Array{T,1},Distribution}} where T&lt;:AbstractFloat" href="#SMC.mvnormal_mixture_draw-Union{Tuple{T}, Tuple{Array{T,1},Distribution}} where T&lt;:AbstractFloat"><code>SMC.mvnormal_mixture_draw</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">`mvnormal_mixture_draw(θ_old::Vector{T}, d_prop::Distribution;
                       c::T = 1.0, α::T = 1.0) where T&lt;:AbstractFloat`</code></pre><p>Create a <code>DegenerateMvNormal</code> distribution object, <code>d</code>, from a parameter vector, <code>p</code>, and a standard deviation matrix (obtained from SVD), <code>σ</code>.</p><p>Generate a draw from the mixture distribution of:</p><ol><li>A <code>DegenerateMvNormal</code> centered at θ_old with the standard deviation matrix <code>σ</code>, scaled by <code>cc^2</code> and with mixture proportion <code>α</code>.</li><li>A <code>DegenerateMvNormal</code> centered at the same mean, but with a standard deviation matrix of the diagonal entries of <code>σ</code> scaled by <code>cc^2</code> with mixture proportion <code>(1 - α)/2</code>.</li><li>A <code>DegenerateMvNormal</code>  with the same standard deviation matrix <code>σ</code> but centered at the new proposed mean, <code>θ_prop</code>, scaled by <code>cc^2</code>, and with mixture proportion <code>(1 - α)/2</code>.</li></ol><p>If no <code>θ_prop</code> is given, but an <code>α</code> is specified, then the mixture will consist of <code>α</code> of the standard distribution and <code>(1 - α)</code> of the diagonalized distribution.</p><p><strong>Arguments</strong></p><ul><li><code>θ_old::Vector{T}</code>: The mean of the desired distribution</li><li><code>σ::Matrix{T}</code>: The standard deviation matrix of the desired distribution</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>cc::T</code>: The standard deviation matrix scaling factor</li><li><code>α::T</code>: The mixing proportion</li><li><code>θ_prop::Vector{T}</code>: The proposed parameter vector to be used as part of the mixture distribution, set by default to be the weighted mean of the particles, prior to mutation.</li></ul><p><strong>Outputs</strong></p><ul><li><code>θ_new::Vector{T}</code>: The draw from the mixture distribution to be used as the MH proposed step</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/helpers.jl#L58-L86">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.compute_ESS-Union{Tuple{T}, Tuple{Array{T,1},Array{T,1},T,T}} where T&lt;:AbstractFloat" href="#SMC.compute_ESS-Union{Tuple{T}, Tuple{Array{T,1},Array{T,1},T,T}} where T&lt;:AbstractFloat"><code>SMC.compute_ESS</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">function `compute_ESS(loglh::Vector{T}, current_weights::Vector{T}, ϕ_n::T, ϕ_n1::T;
                     old_loglh::Vector{T} = zeros(length(loglh))) where {T&lt;:AbstractFloat}`</code></pre><p>Compute ESS given log likelihood, current weights, ϕ<em>n, ϕ</em>{n-1}, and old log likelihood.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/helpers.jl#L159-L165">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.generate_free_blocks-Tuple{Int64,Int64}" href="#SMC.generate_free_blocks-Tuple{Int64,Int64}"><code>SMC.generate_free_blocks</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">`generate_free_blocks(n_free_para::Int64, n_blocks::Int64)`</code></pre><p>Return a Vector{Vector{Int64}} where each internal Vector{Int64} contains a subset of the range 1:n<em>free</em>para of randomly permuted indices. This is used to index out random blocks of free parameters from the covariance matrix for the mutation step.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/helpers.jl#L194-L202">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.generate_all_blocks-Tuple{Array{Array{Int64,1},1},Array{Int64,1}}" href="#SMC.generate_all_blocks-Tuple{Array{Array{Int64,1},1},Array{Int64,1}}"><code>SMC.generate_all_blocks</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">`generate_all_blocks(blocks_free::Vector{Vector{Int64}}, free_para_inds::Vector{Int64})`</code></pre><p>Return a Vector{Vector{Int64}} where each internal Vector{Int64} contains indices corresponding to those in <code>blocks_free</code> but mapping to <code>1:n_para</code> (as opposed to <code>1:n_free_para</code>). These blocks are used to reconstruct the particle vector by inserting the mutated free parameters into the size <code>n_para,</code> particle vector, which also contains fixed parameters.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/helpers.jl#L221-L231">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.mutation-Union{Tuple{U}, Tuple{T}, Tuple{S}, Tuple{Function,Array{AbstractParameter{U},1},Array{S,2},Array{S,1},Array{S,1},Array{S,2},Array{Array{Int64,1},1},Array{Array{Int64,1},1},S,S}} where U&lt;:Number where T&lt;:(AbstractArray{T,2} where T) where S&lt;:AbstractFloat" href="#SMC.mutation-Union{Tuple{U}, Tuple{T}, Tuple{S}, Tuple{Function,Array{AbstractParameter{U},1},Array{S,2},Array{S,1},Array{S,1},Array{S,2},Array{Array{Int64,1},1},Array{Array{Int64,1},1},S,S}} where U&lt;:Number where T&lt;:(AbstractArray{T,2} where T) where S&lt;:AbstractFloat"><code>SMC.mutation</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">mutation(loglikelihood::Function, parameters::ParameterVector{U},
         data::Matrix{S}, p::Vector{S}, d_μ::Vector{S}, d_Σ::Matrix{S},
         blocks_free::Vector{Vector{Int}}, blocks_all::Vector{Vector{Int}},
         ϕ_n::S, ϕ_n1::S; c::S = 1., α::S = 1., n_mh_steps::Int = 1,
         old_data::T = T(undef, size(data, 1), 0)) where {S&lt;:AbstractFloat,
                                                          T&lt;:AbstractMatrix, U&lt;:Number}</code></pre><p>Execute one proposed move of the Metropolis-Hastings algorithm for a given parameter</p><p><strong>Arguments:</strong></p><ul><li><code>loglikelihood::Function</code>: Likelihood function of model being estimated.</li><li><code>parameters::ParameterVector{U}</code>: Model parameter vector, which stores parameter   values, prior dists, and bounds</li><li><code>data::Matrix{Float64}</code>: Matrix of data</li><li><code>p::Vector{Float64}</code>: Initial particle value</li><li><code>d::Distribution</code>: A distribution with μ = the weighted mean, and Σ = the weighted   variance/covariance matrix</li><li><code>blocks_free::Vector{Vector{Int64}}</code>: A vector of index blocks, where the indices   in each block corresponds to the ordering of free parameters only (e.g. all the   indices will be ∈ 1:n<em>free</em>parameters)</li><li><code>blocks_all::Vector{Vector{Int64}}</code>: A vector of index blocks, where the indices in   each block corresponds to the ordering of all parameters (e.g. all the indices will   be in ∈ 1:n_para, free and fixed)</li><li><code>ϕ_n::Float64</code>: The current tempering factor</li><li><code>ϕ_n1::Float64</code>: The previous tempering factor</li></ul><p><strong>Keyword Arguments:</strong></p><ul><li><code>c::Float64</code>: The scaling parameter for the proposed covariance matrix</li><li><code>α::Float64</code>: The mixing proportion</li><li><code>n_mh_steps::Int</code>: Number of Metropolis Hastings steps to attempt</li><li><code>old_data::Matrix{Float64}</code>: The matrix of old data to be used in calculating the   old<em>loglh, old</em>logpost in time tempering</li></ul><p><strong>Outputs:</strong></p><ul><li><code>p::Vector{Float64}</code>: An updated particle containing updated parameter values,   log-likelihood, prior, and acceptance indicator.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/mutation.jl#L1-L41">source</a></section><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>one_draw(loglikelihood::Function, parameters::ParameterVector{U},                   data::Matrix{Float64}) where {U&lt;:Number}</code>. Check Documenter&#39;s build log for details.</p></div></div><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SMC.initial_draw!-Union{Tuple{U}, Tuple{Function,Array{AbstractParameter{U},1},Array{Float64,2},Cloud}} where U&lt;:Number" href="#SMC.initial_draw!-Union{Tuple{U}, Tuple{Function,Array{AbstractParameter{U},1},Array{Float64,2},Cloud}} where U&lt;:Number"><code>SMC.initial_draw!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">function initial_draw!(loglikelihood::Function, parameters::ParameterVector{U},
                       data::Matrix{Float64}, c::Cloud; parallel::Bool = false) where {U&lt;:Number}</code></pre><p>Draw from a general starting distribution (set by default to be from the prior) to initialize the SMC algorithm. Returns a tuple (logpost, loglh) and modifies the particle objects in the particle cloud in place.</p></div></div><a class="source-link" target="_blank" href="https://github.com/FRBNY-DSGE/SMC.jl/blob/7ad237fa2ac734326568eb742a5df02748d480ab/src/initialization.jl#L43-L51">source</a></section><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>draw_likelihood(loglikelihood::Function, parameters::ParameterVector{U},                          data::Matrix{Float64}, draw::Vector{Float64}) where {U&lt;:Number}</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>initialize_likelihoods!(loglikelihood::Function, parameters::ParameterVector{U},                                  data::Matrix{Float64}, c::Cloud;                                  parallel::Bool = false) where {U&lt;:Number}</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition warning"><div class="admonition-title">Missing docstring.</div><div class="admonition-text"><p>Missing docstring for <code>initialize_cloud_settings!(cloud::Cloud; tempered_update::Bool = false,                                     n_parts::Int = 5_000, n_Φ::Int = 300, c::S = 0.5,                                     accept::S = 0.25) where {S&lt;:AbstractFloat}</code>. Check Documenter&#39;s build log for details.</p></div></div><footer><hr/><a class="previous" href="../smc/"><span class="direction">Previous</span><span class="title">Using SMC</span></a><a class="next" href="../license/"><span class="direction">Next</span><span class="title">License</span></a></footer></article></body></html>
